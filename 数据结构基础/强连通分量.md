# 强连通分量

### 定义

​	对于一张有向图而言，它是强连通的当且仅当其上每两个顶点都互相可达，强连通分量是有向图的极大强连通子图

### DFS生成树

<img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\image-20211203234930154.png" alt="image-20211203234930154" style="zoom:50%;" />

有向图的DFS生成树主要有四种边

- 树边(tree edge)：图中以黑色边表示，每次搜索找到一个还没有

### Tarjan算法

##### 变量：

- $dfn_u$: DFS时结点u被搜索的次序
- $low_u$:能够回溯到的最早的已经在栈中的结点，设以u为根的子树为$subtree_u$，$low_u$定义为以下结点的$dfn$的最小值：$subtree_u$中的结点，从$subtree_u$通过一条不在搜索树上的边能达到的结点，也就是能通过最多一条非树边能到达的节点中的最小的dfn序

##### 栈

​	每当搜索到新的点，令它入栈，在对p点的搜索结束时，如果low(p)=n<dfn(q)，p留在栈中，如果low(p)=dfsn(p)，说明p是某个强连通分量的根，不断从栈中弹出元素知道弹出p

##### 流程：

​	按照DFS对图中所有结点进行搜索时，对于结点u和与其相邻的结点v(v不是u的父节点)，考虑三种情况：

- v未被访问：继续对v进行DFS，在回溯过程中，用$low_v$更新$low_u$
- v被访问过，已经在栈中：用$dfn$更新$low_u$
- v被访问过，已不在栈中，说明v已经搜索完毕，其所在连通分量已被处理，所以不用对其做操作

在回溯过程中，判断$dfn_u=low_u$是否成立，如果成立，栈中u极其上方结点构成一个强连通分量

##### 另一种解释

​	对于某个点p为起点的边p->q,：

	- 如果q未被访问过，先递归处理q，然后令low(p)=min(low(p),low(q))
	- 如果q已被访问过且可以从q到达p，令low(p)=min(low(p),dfsn(q))
	- 如果q已被访问过。且从q不能到达p，不做处理

